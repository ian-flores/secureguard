<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Input, Code, and Output Guardrails for Large Language Model Agents • secureguard</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Input, Code, and Output Guardrails for Large Language Model Agents">
<meta name="description" content="Composable guardrails for Large Language Model (LLM) agent workflows. Provides three defense layers -- input validation (prompt injection detection, topic scoping, Personally Identifiable Information (PII) filtering), code analysis (Abstract Syntax Tree (AST) based function blocking, complexity limits, dependency control, data flow restrictions), and output filtering (PII redaction, secret detection, size limits). All analysis is local with zero external API calls. Integrates with securer pre-execution hooks for seamless sandboxed execution.">
<meta property="og:description" content="Composable guardrails for Large Language Model (LLM) agent workflows. Provides three defense layers -- input validation (prompt injection detection, topic scoping, Personally Identifiable Information (PII) filtering), code analysis (Abstract Syntax Tree (AST) based function blocking, complexity limits, dependency control, data flow restrictions), and output filtering (PII redaction, secret detection, size limits). All analysis is local with zero external API calls. Integrates with securer pre-execution hooks for seamless sandboxed execution.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">secureguard</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="articles/secureguard.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="articles/index.html">More articles...</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ian-flores/secureguard/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="secureguard">secureguard<a class="anchor" aria-label="anchor" href="#secureguard"></a>
</h1></div>
<!-- badges: start -->

<blockquote>
<p>[!CAUTION] <strong>Alpha software.</strong> This package is part of a broader effort by <a href="https://github.com/ian-flores" class="external-link">Ian Flores Siaca</a> to develop proper AI infrastructure for the R ecosystem. It is under active development and should <strong>not</strong> be used in production until an official release is published. APIs may change without notice.</p>
</blockquote>
<p>Composable guardrails for LLM agent workflows in R. Three defense layers – input validation, code analysis, and output filtering – all running locally with zero external API calls.</p>
<div class="section level2">
<h2 id="why-secureguard">Why secureguard?<a class="anchor" aria-label="anchor" href="#why-secureguard"></a>
</h2>
<p>Most guardrail solutions require external API calls or cloud services. secureguard runs entirely locally – regex-based prompt injection detection, R AST analysis for dangerous code patterns, and PII/secret scanning – all without sending your data anywhere.</p>
</div>
<div class="section level2">
<h2 id="part-of-the-secure-r-dev-ecosystem">Part of the secure-r-dev Ecosystem<a class="anchor" aria-label="anchor" href="#part-of-the-secure-r-dev-ecosystem"></a>
</h2>
<p>secureguard is part of a 7-package ecosystem for building governed AI agents in R:</p>
<pre><code>                    ┌─────────────┐
                    │   securer    │
                    └──────┬──────┘
          ┌────────────────┼──────────────────┐
          │                │                   │
   ┌──────▼──────┐  ┌─────▼───────────┐  ┌───▼──────────────┐
   │ securetools  │  │&gt;&gt;&gt; secureguard&lt;&lt;&lt;│  │  securecontext   │
   └──────┬───────┘  └─────┬───────────┘  └───┬──────────────┘
          └────────────────┼──────────────────┘
                    ┌──────▼───────┐
                    │   orchestr   │
                    └──────┬───────┘
          ┌────────────────┼─────────────────┐
          │                                  │
   ┌──────▼──────┐                    ┌──────▼──────┐
   │ securetrace  │                   │ securebench  │
   └─────────────┘                    └─────────────┘</code></pre>
<p>secureguard provides the guardrail layer – input validation, code analysis, and output filtering that can run standalone or integrate with securer’s pre-execute hooks. securebench at the bottom of the stack benchmarks guardrail accuracy with precision/recall/F1 metrics.</p>
<table class="table">
<colgroup>
<col width="60%">
<col width="40%">
</colgroup>
<thead><tr class="header">
<th>Package</th>
<th>Role</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><a href="https://github.com/ian-flores/securer" class="external-link">securer</a></td>
<td>Sandboxed R execution with tool-call IPC</td>
</tr>
<tr class="even">
<td><a href="https://github.com/ian-flores/securetools" class="external-link">securetools</a></td>
<td>Pre-built security-hardened tool definitions</td>
</tr>
<tr class="odd">
<td><a href="https://github.com/ian-flores/secureguard" class="external-link">secureguard</a></td>
<td>Input/code/output guardrails (injection, PII, secrets)</td>
</tr>
<tr class="even">
<td><a href="https://github.com/ian-flores/orchestr" class="external-link">orchestr</a></td>
<td>Graph-based agent orchestration</td>
</tr>
<tr class="odd">
<td><a href="https://github.com/ian-flores/securecontext" class="external-link">securecontext</a></td>
<td>Document chunking, embeddings, RAG retrieval</td>
</tr>
<tr class="even">
<td><a href="https://github.com/ian-flores/securetrace" class="external-link">securetrace</a></td>
<td>Structured tracing, token/cost accounting, JSONL export</td>
</tr>
<tr class="odd">
<td><a href="https://github.com/ian-flores/securebench" class="external-link">securebench</a></td>
<td>Guardrail benchmarking with precision/recall/F1 metrics</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"ian-flores/secureguard"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="quick-example">Quick Example<a class="anchor" aria-label="anchor" href="#quick-example"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ian-flores.github.io/secureguard/">secureguard</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Block dangerous code before it runs</span></span>
<span><span class="va">hook</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/as_pre_execute_hook.html">as_pre_execute_hook</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="reference/guard_code_analysis.html">guard_code_analysis</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="reference/guard_code_complexity.html">guard_code_complexity</a></span><span class="op">(</span>max_ast_depth <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">hook</span><span class="op">(</span><span class="st">"mean(1:10)"</span><span class="op">)</span>    <span class="co"># TRUE -- safe</span></span>
<span><span class="fu">hook</span><span class="op">(</span><span class="st">"system('ls')"</span><span class="op">)</span>  <span class="co"># FALSE -- blocked</span></span>
<span></span>
<span><span class="co"># Check output for sensitive data</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/guard_output.html">guard_output</a></span><span class="op">(</span></span>
<span>  <span class="st">"User SSN: 123-45-6789"</span>,</span>
<span>  <span class="fu"><a href="reference/guard_output_pii.html">guard_output_pii</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="reference/guard_output_secrets.html">guard_output_secrets</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="va">pass</span>     <span class="co"># FALSE</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="va">reasons</span>  <span class="co"># "PII detected in output: ssn"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="features">Features<a class="anchor" aria-label="anchor" href="#features"></a>
</h2>
<div class="section level3">
<h3 id="input-guardrails">Input Guardrails<a class="anchor" aria-label="anchor" href="#input-guardrails"></a>
</h3>
<table class="table">
<thead><tr class="header">
<th>Function</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code><a href="reference/guard_prompt_injection.html">guard_prompt_injection()</a></code></td>
<td>Detect prompt injection attempts</td>
</tr>
<tr class="even">
<td><code><a href="reference/guard_topic_scope.html">guard_topic_scope()</a></code></td>
<td>Enforce allowed/blocked topic lists</td>
</tr>
<tr class="odd">
<td><code><a href="reference/guard_input_pii.html">guard_input_pii()</a></code></td>
<td>Filter PII from user prompts</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="code-guardrails">Code Guardrails<a class="anchor" aria-label="anchor" href="#code-guardrails"></a>
</h3>
<table class="table">
<colgroup>
<col width="50%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th>Function</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code><a href="reference/guard_code_analysis.html">guard_code_analysis()</a></code></td>
<td>AST-based blocked function detection</td>
</tr>
<tr class="even">
<td><code><a href="reference/guard_code_complexity.html">guard_code_complexity()</a></code></td>
<td>Depth, call count, expression limits</td>
</tr>
<tr class="odd">
<td><code><a href="reference/guard_code_dependencies.html">guard_code_dependencies()</a></code></td>
<td>Namespace allow/block lists</td>
</tr>
<tr class="even">
<td><code><a href="reference/guard_code_dataflow.html">guard_code_dataflow()</a></code></td>
<td>Assignment and global variable restrictions</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="output-guardrails">Output Guardrails<a class="anchor" aria-label="anchor" href="#output-guardrails"></a>
</h3>
<table class="table">
<colgroup>
<col width="50%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th>Function</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code><a href="reference/guard_output_pii.html">guard_output_pii()</a></code></td>
<td>PII detection with block/redact/warn actions</td>
</tr>
<tr class="even">
<td><code><a href="reference/guard_output_secrets.html">guard_output_secrets()</a></code></td>
<td>Secret detection with block/redact/warn actions</td>
</tr>
<tr class="odd">
<td><code><a href="reference/guard_output_size.html">guard_output_size()</a></code></td>
<td>Character, line, and element limits</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="integration">Integration<a class="anchor" aria-label="anchor" href="#integration"></a>
</h3>
<table class="table">
<thead><tr class="header">
<th>Function</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code><a href="reference/as_pre_execute_hook.html">as_pre_execute_hook()</a></code></td>
<td>Convert code guardrails to a securer hook</td>
</tr>
<tr class="even">
<td><code><a href="reference/guard_output.html">guard_output()</a></code></td>
<td>Run output guardrails with redaction support</td>
</tr>
<tr class="odd">
<td><code><a href="reference/secure_pipeline.html">secure_pipeline()</a></code></td>
<td>Bundle input + code + output guardrails</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="securer-integration">securer Integration<a class="anchor" aria-label="anchor" href="#securer-integration"></a>
</h2>
<p>secureguard integrates with <a href="https://github.com/ian-flores/securer" class="external-link">securer</a> for sandboxed R execution:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ian-flores.github.io/securer/" class="external-link">securer</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ian-flores.github.io/secureguard/">secureguard</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">pipeline</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/secure_pipeline.html">secure_pipeline</a></span><span class="op">(</span></span>
<span>  input_guardrails <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="reference/guard_prompt_injection.html">guard_prompt_injection</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  code_guardrails <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="reference/guard_code_analysis.html">guard_code_analysis</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  output_guardrails <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="reference/guard_output_pii.html">guard_output_pii</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="reference/guard_output_secrets.html">guard_output_secrets</a></span><span class="op">(</span>action <span class="op">=</span> <span class="st">"redact"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">sess</span> <span class="op">&lt;-</span> <span class="va"><a href="https://ian-flores.github.io/securer/reference/SecureSession.html" class="external-link">SecureSession</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  pre_execute_hook <span class="op">=</span> <span class="va">pipeline</span><span class="op">$</span><span class="fu">as_pre_execute_hook</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Safe code executes normally</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="va">sess</span><span class="op">$</span><span class="fu">execute</span><span class="op">(</span><span class="st">"mean(1:10)"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Dangerous code is blocked before reaching the sandbox</span></span>
<span><span class="va">sess</span><span class="op">$</span><span class="fu">execute</span><span class="op">(</span><span class="st">"system('ls')"</span><span class="op">)</span>  <span class="co"># Error: blocked by guardrail</span></span>
<span></span>
<span><span class="co"># Check output</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="va">pipeline</span><span class="op">$</span><span class="fu">check_output</span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="va">sess</span><span class="op">$</span><span class="fu">close</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="documentation">Documentation<a class="anchor" aria-label="anchor" href="#documentation"></a>
</h2>
<ul>
<li><a href="https://ian-flores.github.io/secureguard/articles/secureguard.html">Getting Started with secureguard</a></li>
<li><a href="https://ian-flores.github.io/secureguard/articles/advanced-patterns.html">Advanced Guardrail Patterns</a></li>
<li><a href="https://ian-flores.github.io/secureguard/">Full reference documentation</a></li>
</ul>
</div>
<div class="section level2">
<h2 id="contributing">Contributing<a class="anchor" aria-label="anchor" href="#contributing"></a>
</h2>
<p>Contributions are welcome! Please file issues on GitHub and submit pull requests.</p>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>MIT</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/ian-flores/secureguard/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/ian-flores/secureguard/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing secureguard</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Ian Flores Siaca <br><small class="roles"> Author, maintainer, copyright holder </small>   </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/ian-flores/secureguard/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/ian-flores/secureguard/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/ian-flores/secureguard" class="external-link"><img src="https://codecov.io/gh/ian-flores/secureguard/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
<li><a href="https://ian-flores.github.io/secureguard/"><img src="https://github.com/ian-flores/secureguard/actions/workflows/pkgdown.yaml/badge.svg" alt="pkgdown"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ian Flores Siaca.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
