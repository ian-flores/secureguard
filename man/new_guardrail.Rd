% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/guardrail.R
\name{new_guardrail}
\alias{new_guardrail}
\title{Create a new guardrail}
\usage{
new_guardrail(name, type, check_fn, description = "")
}
\arguments{
\item{name}{Character(1). Short identifier for the guardrail.}

\item{type}{Character(1). One of \code{"input"}, \code{"code"}, or \code{"output"}.}

\item{check_fn}{A function taking a single argument and returning a
\code{\link[=guardrail_result]{guardrail_result()}}.}

\item{description}{Character(1). Human-readable description.}
}
\value{
An S7 object of class \code{secureguard}.
}
\description{
Low-level constructor for guardrail objects. Prefer the \verb{guard_*()} factory
functions for end-user guardrails.
}
\examples{
g <- new_guardrail(
  name = "no_eval",
  type = "code",
  check_fn = function(code) {
    if (grepl("\\\\beval\\\\b", code)) {
      guardrail_result(pass = FALSE, reason = "eval() detected")
    } else {
      guardrail_result(pass = TRUE)
    }
  },
  description = "Blocks eval() calls"
)
g@name
run_guardrail(g, "x <- 1")
}
