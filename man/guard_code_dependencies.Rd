% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/code-dependency.R
\name{guard_code_dependencies}
\alias{guard_code_dependencies}
\title{Code dependency guardrail}
\usage{
guard_code_dependencies(
  allowed_packages = NULL,
  denied_packages = NULL,
  allow_base = TRUE
)
}
\arguments{
\item{allowed_packages}{Character vector of permitted package names
(allowlist mode). If non-\code{NULL}, only these packages (plus base packages
if \code{allow_base = TRUE}) are permitted. Cannot be used together with
\code{denied_packages}.}

\item{denied_packages}{Character vector of denied package names (denylist
mode). If non-\code{NULL}, these packages are blocked. Cannot be used together
with \code{allowed_packages}.}

\item{allow_base}{Logical(1). If \code{TRUE} (default), base R packages
(\code{base}, \code{utils}, \code{stats}, \code{methods}, \code{grDevices}, \code{graphics},
\code{datasets}) are always permitted regardless of allowlist/denylist.}
}
\value{
A guardrail object of class \code{"secureguard"} with type \code{"code"}.
}
\description{
Creates a guardrail that controls which packages can be used in R code.
Detects package usage via \code{library()}, \code{require()}, \code{pkg::fn},
\code{pkg:::fn}, and \code{loadNamespace()} calls.
}
\examples{
g <- guard_code_dependencies(denied_packages = "processx")
run_guardrail(g, "library(dplyr)")
run_guardrail(g, "processx::run('ls')")
}
