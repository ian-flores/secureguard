% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/output-secrets.R
\name{guard_output_secrets}
\alias{guard_output_secrets}
\title{Secret output guardrail}
\usage{
guard_output_secrets(detect = NULL, action = c("block", "redact", "warn"))
}
\arguments{
\item{detect}{Character vector of secret types to detect. Defaults to all
types from \code{\link[=secret_patterns]{secret_patterns()}}: \code{"api_key"}, \code{"aws_key"}, \code{"password"},
\code{"token"}, \code{"private_key"}, \code{"github_token"}.}

\item{action}{Character(1). What to do when secrets are found:
\itemize{
\item \code{"block"} (default): fail the check.
\item \code{"redact"}: pass but replace secrets with \verb{[REDACTED_API_KEY]} etc.
\item \code{"warn"}: pass with advisory warnings.
}}
}
\value{
A guardrail object of class \code{"secureguard"} with type \code{"output"}.
}
\description{
Creates a guardrail that scans output for secrets and credentials.
}
\examples{
g <- guard_output_secrets()
run_guardrail(g, "AKIAIOSFODNN7EXAMPLE")

g_redact <- guard_output_secrets(action = "redact")
result <- run_guardrail(g_redact, "AKIAIOSFODNN7EXAMPLE")
result$details$redacted_text
}
