% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/code-ast-analysis.R
\name{guard_code_analysis}
\alias{guard_code_analysis}
\title{Code AST analysis guardrail}
\usage{
guard_code_analysis(
  blocked_functions = default_blocked_functions(),
  allow_namespaces = NULL,
  detect_indirect = TRUE
)
}
\arguments{
\item{blocked_functions}{Character vector of function names to block.
Defaults to \code{\link[=default_blocked_functions]{default_blocked_functions()}}. Names can include namespace
prefixes (e.g. \code{"processx::run"}).}

\item{allow_namespaces}{Character vector of package prefixes to allow even
if a function from that package appears in \code{blocked_functions}. For
example, \code{allow_namespaces = "dplyr"} would allow \code{dplyr::filter}.}

\item{detect_indirect}{Logical(1). If \code{TRUE} (default), also detect indirect
calls via \code{do.call("system", ...)} where the first argument is a string
literal matching a blocked function.}
}
\value{
A guardrail object of class \code{"secureguard"} with type \code{"code"}.
}
\description{
Creates a guardrail that inspects R code for calls to blocked functions.
Uses AST walking to detect direct calls and optionally indirect invocation
via \code{do.call()}.
}
\examples{
g <- guard_code_analysis()
run_guardrail(g, "x <- 1 + 2")
run_guardrail(g, "system('ls')")
}
